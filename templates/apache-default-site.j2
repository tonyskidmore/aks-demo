<VirtualHost *:443>
    SSLEngine on
    SSLCipherSuite EECDH+AESGCM:EDH+AESGCM:AES256+EECDH:AES256+EDH
    SSLProtocol All -SSLv2 -SSLv3 -TLSv1 -TLSv1.1
    SSLHonorCipherOrder On
    SSLCertificateFile /etc/ssl/certs/{{ ansible_fqdn }}.pem
    SSLCertificateKeyFile /etc/ssl/certs/{{ ansible_fqdn}}.key

    # HSTS (optional)
    Header always set Strict-Transport-Security "max-age=63072000; includeSubdomains;"
    # Remove this if you need to use frames or iframes
    Header always set X-Frame-Options DENY
    # Prevent MIME based attacks
    Header set X-Content-Type-Options "nosniff"

    ServerAdmin  {{ apache_role_server_admin }}
    ProxyRequests     Off
    ProxyPreserveHost On
    AllowEncodedSlashes NoDecode
    <Proxy *>
        Order deny,allow
        Allow from all
    </Proxy>
    ProxyPass         /  http://localhost:8080/ nocanon
    ProxyPassReverse  /  http://localhost:8080/
    ProxyPassReverse  /  http://{{ ansible_fqdn }}/
    ProxyPassReverse  /  https://{{ ansible_fqdn }}/
    RequestHeader set X-Forwarded-Proto "https"
    RequestHeader set X-Forwarded-Port "443"
</VirtualHost>
